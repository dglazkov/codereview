<link rel="import" href="../third_party/polymer-all/polymer-elements/polymer-ajax/polymer-ajax.html">

<polymer-element name="rietveld-issue" attributes="number">
  <template>
    <polymer-ajax
        auto
        url="https://codereview.chromium.org/api/{{number}}"
        handleAs="json"
        id="ajax"
        on-polymer-response="issueLoadSucceeded"
        on-polymer-error="issueLoadFailed">
    </polymer-ajax>

    <template if="{{ issue }}">
      <h1>{{ issue.subject }}</h1>
      <p>{{ issue.description }}</p>
    </template>

    <template if="{{ error }}">
      <h1>Issue {{number}} failed to load.</h1>
      <p>{{error}}</p>
    </template>
  </template>
  <script>
  Polymer('rietveld-issue', {
    number: '',
    issue: null,
    error: '',
    numberChanged: function() {
      this.issue = null;
      this.error = '';
    },
    issueLoadSucceeded: function(event) {
      this.issue = event.detail.response;
    },
    issueLoadFailed: function(event) {
      this.error = event.detail.response;
    },
  });
  </script>
</polymer-element>
